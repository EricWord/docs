[TOC]

# 1. DWS与DWM层的设计

## 1.1 设计思路

![image-20210528204103935](images/image-20210528204103935.png)

## 1.2 需求梳理

![image-20210528204216036](images/image-20210528204216036.png)

![image-20210528205027223](images/image-20210528205027223.png)

![image-20210528205155898](images/image-20210528205155898.png)





# 2. DWM层-访客UV计算

## 2.1 需求分析与思路

![image-20210528205630285](images/image-20210528205630285.png)

## 2.2 代码实现

### 2.2.1 从kafka的dwd page log主题接收数据

![image-20210528212520973](images/image-20210528212520973.png)





# 3. DWM层-跳出明细计算





# 4. DWM层-订单宽表







# 5. DWM层-支付宽表(练习)



# 6. 总结



