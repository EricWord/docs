# 9.方法区





## 9.1 栈、堆、方法区的交互关系

### 9.1.1 运行时数据区结构图

![image-20210512150928108](images/image-20210512150928108.png)



![image-20210512150913211](images/image-20210512150913211.png)

### 9.1.2 堆、栈、方法区的交互关系

![image-20210512151149671](images/image-20210512151149671.png)

## 9.2 方法区的理解

### 9.2.1 官方文档

![image-20210512151433890](images/image-20210512151433890.png)

### 9.2.2 方法区在哪里

![image-20210512152558571](images/image-20210512152558571.png)

![image-20210512152855594](images/image-20210512152855594.png)

### 9.2.3 Hotspot中方法区的演进

![image-20210512153548902](images/image-20210512153548902.png)

![image-20210512154014896](images/image-20210512154014896.png)

![image-20210512154034204](images/image-20210512154034204.png)

## 9.3 设置方法区大小与OOM

### 9.3.1 设置方法区内存的大小

![image-20210512154342079](images/image-20210512154342079.png)

![image-20210512154400880](images/image-20210512154400880.png)

### 9.3.2 OOM的代码例子

![image-20210512155215137](images/image-20210512155215137.png)

![image-20210512155312739](images/image-20210512155312739.png)

### 9.3.3 如何解决OOM

![image-20210512155707205](images/image-20210512155707205.png)

## 9.4 方法区的内部结构

![image-20210512160045258](images/image-20210512160045258.png)



### 9.4.1 方法区(Method Area)存储什么

![image-20210512160225999](images/image-20210512160225999.png)

### 9.4.2 类型信息

![image-20210512160449080](images/image-20210512160449080.png)

### 9.4.3 域(Field)信息

![image-20210512160537698](images/image-20210512160537698.png)

### 9.4.4 方法(Method)信息

![image-20210512160631769](images/image-20210512160631769.png)

### 9.4.5 non-final的类变量

![image-20210512161520253](images/image-20210512161520253.png)

![image-20210512161651545](images/image-20210512161651545.png)

### 9.4.6 运行时常量池VS常量池

![image-20210512162130904](images/image-20210512162130904.png)

![image-20210512162203140](images/image-20210512162203140.png)

![image-20210512162453530](images/image-20210512162453530.png)



### 9.4.7 为什么需要常量池

![image-20210512162622784](images/image-20210512162622784.png)

### 9.4.8 常量池中有什么

![image-20210512163419984](images/image-20210512163419984.png)

![image-20210512163457714](images/image-20210512163457714.png)

### 9.4.9 运行时常量池

![image-20210512163612381](images/image-20210512163612381.png)

## 9.5 方法区使用举例

![image-20210512165127331](images/image-20210512165127331.png)

![image-20210512165358727](images/image-20210512165358727.png)

## 9.6 方法区的演进细节

![image-20210512170253798](images/image-20210512170253798.png)

![image-20210512170635867](images/image-20210512170635867.png)

![image-20210512170704943](images/image-20210512170704943.png)

![image-20210512170725077](images/image-20210512170725077.png)

## 9.6.1 永久代为什么要被元空间替换？

![image-20210512170824184](images/image-20210512170824184.png)

![image-20210512171313039](images/image-20210512171313039.png)

### 9.6.2 StringTable为什么要调整

![image-20210512172158611](images/image-20210512172158611.png)

### 9.6.3 静态变量放在哪

![image-20210512172341329](images/image-20210512172341329.png)

![image-20210512172704556](images/image-20210512172704556.png)

![image-20210512172829589](images/image-20210512172829589.png)

![image-20210512172956854](images/image-20210512172956854.png)

## 9.7 方法区的垃圾回收

![image-20210512173114584](images/image-20210512173114584.png)

![image-20210512173551147](images/image-20210512173551147.png)

![image-20210512173708660](images/image-20210512173708660.png)

## 9.8 总结

![image-20210512174043819](images/image-20210512174043819.png)

### 9.8.1 常见面试题

![image-20210512174227875](images/image-20210512174227875.png)

![image-20210512174247796](images/image-20210512174247796.png)

