# 20. 类的加载过程

## 20.1 概述

![image-20210515213301123](images/image-20210515213301123.png)

![image-20210515213503753](images/image-20210515213503753.png)

![image-20210515213647859](images/image-20210515213647859.png)

## 20.2 过程一:Loading(加载)阶段

### 20.2.1 加载完成的操作

![image-20210515213907891](images/image-20210515213907891.png)

### 20.2.2 二进制流的获取方式

![image-20210515214142827](images/image-20210515214142827.png)

### 20.2.3 类模型与Class实例的位置

![image-20210515214358632](images/image-20210515214358632.png)

![image-20210515214339141](images/image-20210515214339141.png)

![image-20210515214537070](images/image-20210515214537070.png)

### 20.2.4 数组类的加载

![image-20210515214754433](images/image-20210515214754433.png)

## 20.3 过程二:Linking(链接)阶段

### 20.3.1 环节1:Verification(验证)

![image-20210515215159493](images/image-20210515215159493.png)

![image-20210515215306487](images/image-20210515215306487.png)

![image-20210515215337148](images/image-20210515215337148.png)

![image-20210515215404631](images/image-20210515215404631.png)

![image-20210515215658435](images/image-20210515215658435.png)

![image-20210515215935733](images/image-20210515215935733.png)

### 20.3.2 环节2:Preparation(准备)

![image-20210515220107104](images/image-20210515220107104.png)

![image-20210516082827670](images/image-20210516082827670.png)

![image-20210516083331777](images/image-20210516083331777.png)

### 20.3.3 环节3:Resolution(解析)

![image-20210516083401785](images/image-20210516083401785.png)

![image-20210516083719624](images/image-20210516083719624.png)

![image-20210516083856647](images/image-20210516083856647.png)

![image-20210516084018797](images/image-20210516084018797.png)

## 20.4 过程三:Initialization(初始化)阶段

![image-20210516084146960](images/image-20210516084146960.png)

![image-20210516084640783](images/image-20210516084640783.png)

### 20.4.1 static与final的搭配问题



![image-20210516085057231](images/image-20210516085057231.png)

![image-20210516090220967](images/image-20210516090220967.png)

### 20.4.2 `<clinit>`的线程安全

![image-20210516090318121](images/image-20210516090318121.png)

### 20.4.3 类的初始化情况:主动使用vs被动使用

![image-20210516090842470](images/image-20210516090842470.png)

![image-20210516094237511](images/image-20210516094237511.png)

![image-20210516095013020](images/image-20210516095013020.png)





![image-20210516090947029](images/image-20210516090947029.png)



![image-20210516094114952](images/image-20210516094114952.png)



## 20.5 过程四:类的Using(使用)

![image-20210515220333973](images/image-20210515220333973.png)

## 20.6 过程五:类的Unloading(卸载)

![image-20210516100650421](images/image-20210516100650421.png)

![image-20210516100708931](images/image-20210516100708931.png)

![image-20210516100738697](images/image-20210516100738697.png)

![image-20210516101550000](images/image-20210516101550000.png)

![image-20210516101301428](images/image-20210516101301428.png)

![image-20210516101131458](images/image-20210516101131458.png)